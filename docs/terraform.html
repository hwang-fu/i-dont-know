<!-- * * * * * * * * * * * * * * -->
<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Terraform</title>

    <!-- Theme (pick any from Prism site) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.css">

    <!-- Prism core + Lisp language -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/autoloader/prism-autoloader.min.js"
            data-prismjs-autoloader-path="https://cdn.jsdelivr.net/npm/prismjs/components/"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.js"></script>

<style>
    table {
        border-collapse: collapse;      /* merge borders so you don't get double lines */
        width: 100%;                    /* optional: make it full width */
        font-family: "KaiTi", "æ¥·ä½“", "STKaiti", "Kaiti SC", serif;
        font-size: 14px;
    }

    th {
        background-color: #f5f5f5;      /* light gray header background */
        text-align: left;               /* header text alignment */
        font-weight: 600;
    }

    th, td {
        border: 1px solid #ddd;         /* subtle border color */
        padding: 8px 12px;              /* breathing room */
    }

    tr:nth-child(even) {
        background-color: #fafafa;      /* zebra striping for readability */
    }

    tr:hover {
        background-color: #f0f8ff;      /* light hover highlight */
    }

    .comment {
        color: grey;
    }

    .token.keyword {
        font-weight: 500;
    }
    /*
    .token.comment {
        color: #888;
    }
    */

    .red-underline {
        text-decoration-line: underline;
        text-decoration-color: red;
        text-decoration-thickness: 2px; /* optional: make it a bit thicker */
        text-underline-offset: 2px;     /* optional: move it slightly down */
    }

    body {
        font-family: "KaiTi", "æ¥·ä½“", "STKaiti", "Kaiti SC", serif;
        font-variant-ligatures: none;
    }

    ul > li {
        list-style-type: disc;
    }

    code {
        color: #24292e;                     /* text */
        background-color: #f6f8fa;          /* bg */
        border: 1px solid #d0d7de;          /* subtle frame */
        border-radius: .375rem;
        padding: .15rem .35rem;
        font-family: "FiraCode Nerd Font", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
        font-size: 0.875rem;                /* 14px-ish; avoid bare numbers */
        line-height: 1.4;
    }

    /* Block code container */
    pre {
        margin: 1rem 0;
        padding: .8rem 1rem;
        background-color: #f6f8fa;       /* match inline bg */
        border: 1px solid #d0d7de;
        border-radius: .5rem;
        overflow: auto;                   /* scroll if long */
        tab-size: 4;                      /* adjust as needed */
    }

    /* Code inside pre: remove extra padding/background from inline style */
    pre code {
        display: block;                   /* ensure full-width */
        padding: 0;                       /* pre handles padding */
        background: transparent;          /* avoid double bg */
        border: 0;                        /* avoid double border */
        color: #24292e;
        font-family: "FiraCode Nerd Font", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
        font-size: 0.875rem;
        line-height: 1.5;
        white-space: pre;                 /* preserve spacing; use pre-wrap to wrap long lines */
    }
</style>
</head>
<!-- * * * * * * * * * * * * * * -->
<body>
<!-- * * * * * * * * * * * * * * -->


<hr/>


<!-- * * * * * * * * * * * * * * -->
<nav id="toc" style="margin-bottom: 2rem;">
    <h2>ðŸ“˜ Terraform Documentation Index</h2>
    <ul style="line-height: 1.8;">
        <li><a href="#tf-what-is-terraform">What Is Terraform?</a></li>
    </ul>
</nav>
<!-- * * * * * * * * * * * * * * -->


<hr/>


<!-- * * * * * * * * * * * * * * -->
<h3 id="tf-what-is-terraform">What Is Terraform?</h3>
<ol>
    <li><b>Introduction</b></li>
    <br/>
    <ul>
        <li><code>Terraform</code> is an open-source <u>Infrastructure as Code (IaC)</u> tool created by HashiCorp.</li>
        <br/>
        <li>It allows you to <u>define, provision, and manage infrastructure</u>
            across multiple cloud providers using a declarative configuration language (HCL â€” HashiCorp Configuration Language).</li>
        <br/>
        <li>Instead of clicking in cloud dashboards, you write code describing your infrastructure â€” Terraform takes care of creating, updating, and deleting resources safely.</li>
    </ul>
    <br/><br/>


    <li><b>Key Characteristics</b></li>
    <br/>
    <ul>
        <li>You describe <u>what</u> you want, not <u>how</u> to do it.</li>
        <li>Supports many providers:
            <ul>
                <li>AWS, Azure, Google Cloud</li>
                <li>Alibaba Cloud, Oracle Cloud</li>
                <li>Kubernetes</li>
                <li>GitHub, Cloudflare, Datadog, etc.</li>
            </ul>
        </li>
        <li>Safe <u>execution plan</u> via <code>terraform plan</code>.</li>
        <li>Manages <u>dependencies</u> between resources automatically.</li>
        <li>Uses a <u>state file</u> to track real-world infrastructure.</li>
        <li>Works well in CI/CD pipelines.</li>
    </ul>
    <br/><br/>


    <li><b>Terraform Workflow</b></li>
    <br/>
    <ul>
        <li>Terraform follows a simple but powerful 4-step workflow:</li>
    </ul>

    <br/>
    <table>
        <thead>
            <tr>
                <th>Step</th>
                <th>Description</th>
                <th>Command</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><b>1. Write</b></td>
                <td>Write <code>.tf</code> files describing infrastructure.</td>
                <td>â€”</td>
            </tr>
            <tr>
                <td><b>2. Init</b></td>
                <td>Download providers and initialize the project.</td>
                <td><code>terraform init</code></td>
            </tr>
            <tr>
                <td><b>3. Plan</b></td>
                <td>Show what Terraform will create, modify, or destroy.</td>
                <td><code>terraform plan</code></td>
            </tr>
            <tr>
                <td><b>4. Apply</td>
                <td>Perform the actual infrastructure change.</td>
                <td><code>terraform apply</code></td>
            </tr>
        </tbody>
    </table>
    <br/><br/>


    <li><b>A Simple Terraform Example</b></li>
    <br/>
    <p>This example creates an AWS EC2 instance.</p>

<pre><code class="language-hcl line-numbers">provider "aws" {
  region = "eu-central-1"
}

resource "aws_instance" "example" {
  ami           = "ami-12345678"
  instance_type = "t2.micro"
}
</code></pre>

    <br/>
    <ul>
        <li><code>provider</code> block tells Terraform which cloud provider to use.</li>
        <li><code>resource</code> block describes an actual cloud object.</li>
        <li><code>aws_instance.example</code> becomes a managed resource in the Terraform state.</li>
    </ul>
    <br/><br/>


    <li><b>Terraform State</b></li>
    <br/>
    <ul>
        <li>Terraform stores infrastructure details in a file called <code>terraform.tfstate</code>.</li>
        <br/>
        <li>This file tracks:
            <ul>
                <li>resource IDs</li>
                <li>connections between resources</li>
                <li>current configuration applied</li>
            </ul>
        </li>
        <br/>
        <li>This allows Terraform to detect changes and update resources safely.</li>
        <br/>
        <li>In teams, the state is usually stored remotely (S3, Azure Blob, Terraform Cloud).</li>
    </ul>
    <br/><br/>


    <li><b>Terraform Language (HCL)</b></li>
    <br/>
    <ul>
        <li>Terraform uses <u>HCL (HashiCorp Configuration Language)</u>, which is:</li>
        <ul>
            <li>easy to read</li>
            <li>block-based</li>
            <li>supports variables, loops, functions, expressions</li>
        </ul>
        <br/>
        <li>Examples of HCL blocks:</li>
    </ul>

<pre><code class="language-hcl line-numbers">variable "project_name" {
  type = string
}

output "instance_id" {
  value = aws_instance.example.id
}
</code></pre>
    <br/><br/>


    <li><b>Common Terraform Terminology</b></li>
    <br/>
    <table>
        <thead>
            <tr>
                <th>Term</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><code>provider</code></td>
                <td>Plugin to manage a service (e.g., AWS, Azure).</td>
            </tr>
            <tr>
                <td><code>resource</code></td>
                <td>A cloud object (VM, network, DB, etc.).</td>
            </tr>
            <tr>
                <td><code>data source</code></td>
                <td>Read existing infrastructure.</td>
            </tr>
            <tr>
                <td><code>module</code></td>
                <td>Reusable grouping of Terraform files.</td>
            </tr>
            <tr>
                <td><code>state</code></td>
                <td>The file storing real-world infrastructure details.</td>
            </tr>
            <tr>
                <td><code>plan</code></td>
                <td>Preview of actions before applying changes.</td>
            </tr>
            <tr>
                <td><code>apply</code></td>
                <td>Run the actual changes.</td>
            </tr>
        </tbody>
    </table>
    <br/><br/>

</ol>
<br/>
<!-- * * * * * * * * * * * * * * -->


<hr/>


<!-- * * * * * * * * * * * * * * -->
<h3 id="terraform-lifecycle">Terraform Resource Lifecycle</h3>
<ol>
    <li><b>Introduction</b></li>
    <br/>
    <ul>
        <li>Every Terraform <code>resource</code> has a <u>lifecycle</u> â€” a set of rules controlling how Terraform creates, updates, and destroys it.</li>
        <br/>
        <li>You can use the <code>lifecycle</code> block inside a resource to modify Terraform's default behavior.</li>
    </ul>
    <br/><br/>


    <li><b>The <code>lifecycle</code> Block Structure</b></li>

<pre><code class="language-hcl line-numbers">resource "aws_instance" "example" {
  ami           = "ami-123456"
  instance_type = "t2.micro"

  lifecycle {
    create_before_destroy = false
    prevent_destroy       = false
    ignore_changes        = []
  }
}
</code></pre>

    <br/>
    <ul>
        <li>The <code>lifecycle</code> block works inside <code>resource</code> definitions only.</li>
        <li>It modifies how Terraform handles changes, updates, and destruction.</li>
    </ul>
    <br/><br/>


    <li><b><code>create_before_destroy</code></b></li>
    <br/>
    <ul>
        <li>Normally Terraform does:
            <ul>
                <li>destroy the old resource</li>
                <li>then create a new one</li>
            </ul>
        </li>
        <br/>
        <li><code>create_before_destroy = true</code> reverses this order:
            <ul>
                <li>create new resource <u>first</u></li>
                <li>destroy the old one <u>after</u></li>
            </ul>
        </li>
        <br/>
        <li>Useful when:
            <ul>
                <li>you want zero downtime</li>
                <li>your resource cannot be deleted before a replacement exists</li>
            </ul>
        </li>
    </ul>

<pre><code class="language-hcl line-numbers">lifecycle {
  create_before_destroy = true
}
</code></pre>

    <br/><br/>


    <li><b><code>prevent_destroy</code></b></li>
    <br/>
    <ul>
        <li>Protects a resource from <u>accidental deletion</u>.</li>
        <li>If Terraform needs to destroy it, the <code>apply</code> will abort with an error.</li>
        <br/>
        <li>Commonly used for:
            <ul>
                <li>production databases</li>
                <li>S3 buckets containing critical data</li>
                <li>shared networks</li>
            </ul>
        </li>
    </ul>

<pre><code class="language-hcl line-numbers">lifecycle {
  prevent_destroy = true
}
</code></pre>

    <br/>
    <ul>
        <li>To override, you must temporarily remove <code>prevent_destroy</code> or force destruction with <code>-target</code> flags.</li>
    </ul>
    <br/><br/>


    <li><b><code>ignore_changes</code></b></li>
    <br/>
    <ul>
        <li>Tells Terraform to <u>ignore drift</u> on certain fields.</li>
        <li>Useful when some fields are updated by:
            <ul>
                <li>cloud providers</li>
                <li>external scripts</li>
                <li>manually modified settings</li>
            </ul>
        </li>
        <br/>
        <li>Prevents Terraform from trying to "fix" changes you donâ€™t want overwritten.</li>
    </ul>

<pre><code class="language-hcl line-numbers">lifecycle {
  ignore_changes = [
    tags,
    metadata,
  ]
}
</code></pre>

    <br/>
    <ul>
        <li>Supports:
            <ul>
                <li>single attribute</li>
                <li>multiple attributes</li>
                <li><code>ignore_changes = all</code> (dangerous!)</li>
            </ul>
        </li>
    </ul>
    <br/><br/>


    <li><b>Full Lifecycle Example</b></li>

<pre><code class="language-hcl line-numbers">resource "aws_instance" "server" {
  ami           = "ami-123456"
  instance_type = "t3.micro"

  lifecycle {
    create_before_destroy = true
    prevent_destroy       = false
    ignore_changes        = [
      tags["last_updated"],
      user_data,
    ]
  }
}
</code></pre>

    <br/>
    <ul>
        <li>This resource:
            <ul>
                <li>gets replaced without downtime</li>
                <li>can be destroyed normally</li>
                <li>does not react to changes in <code>user_data</code> or <code>tags.last_updated</code></li>
            </ul>
        </li>
    </ul>
    <br/><br/>


    <li><b>Lifecycle vs Depends On</b></li>
    <br/>
    <ul>
        <li>Lifecycle provides <u>behavior customization</u>.</li>
        <li><code>depends_on</code> enforces <u>ordering</u> between resources.</li>
        <br/>
        <li>They work together but serve different purposes.</li>
    </ul>

<pre><code class="language-hcl line-numbers">resource "aws_eip" "ip" {
  depends_on = [aws_instance.server]
}
</code></pre>
    <br/><br/>


    <li><b>Summary</b></li>
    <br/>
    <table>
        <thead>
            <tr>
                <th>Setting</th>
                <th>Description</th>
                <th>Common Use Case</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><code>create_before_destroy</code></td>
                <td>Create replacement before destroying old resource</td>
                <td>Zero downtime deployments</td>
            </tr>
            <tr>
                <td><code>prevent_destroy</code></td>
                <td>Protect resource from deletion</td>
                <td>Critical databases, S3 buckets</td>
            </tr>
            <tr>
                <td><code>ignore_changes</code></td>
                <td>Ignore drift on specific attributes</td>
                <td>Provider-controlled fields, timestamps</td>
            </tr>
        </tbody>
    </table>
    <br/><br/>

</ol>
<br/>
<!-- * * * * * * * * * * * * * * -->


<hr/>


<!-- * * * * * * * * * * * * * * -->

<!-- * * * * * * * * * * * * * * -->


<hr/>


<!-- * * * * * * * * * * * * * * -->

<!-- * * * * * * * * * * * * * * -->


<hr/>
<!-- * * * * * * * * * * * * * * -->

<footer>
    <p>&copy; 2025 Hwangfucius. All rights reserved.</p>
</footer>
</body>
<!-- * * * * * * * * * * * * * * -->
</html>
<!-- * * * * * * * * * * * * * * -->
