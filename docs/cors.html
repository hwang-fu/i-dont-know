<!-- * * * * * * * * * * * * * * -->
<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Cross-Origin Resource Sharing</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.css">

    <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/autoloader/prism-autoloader.min.js"
            data-prismjs-autoloader-path="https://cdn.jsdelivr.net/npm/prismjs/components/"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.js"></script>

<style>
    html {
        scroll-behavior: smooth;
    }

    .back-to-top {
        position: fixed;
        right: 20px;
        bottom: 20px;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: #333;
        color: #fff;
        display: flex;
        align-items: center;
        justify-content: center;
        text-decoration: none;
        font-size: 22px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        opacity: 0.75;
        transition: opacity 0.2s ease, transform 0.2s ease;
        z-index: 999;
    }

    .back-to-top:hover {
        opacity: 1;
        transform: translateY(-2px);
    }

    .nav-icon {
        width: 18px;
        height: 18px;
        object-fit: contain;
        vertical-align: middle;
        margin-left: 0.3rem;
    }

    table {
        border-collapse: collapse;
        width: 100%;
        font-family: "KaiTi", "楷体", "STKaiti", "Kaiti SC", "Times New Roman", Georgia, serif;
        font-size: 14px;
    }

    th {
        background-color: #f5f5f5;
        text-align: left;
        font-weight: 600;
    }

    th, td {
        border: 1px solid #ddd;
        padding: 8px 12px;
    }

    tr:nth-child(even) {
        background-color: #fafafa;
    }

    tr:hover {
        background-color: #f0f8ff;
    }

    .comment {
        color: grey;
    }

    .token.keyword {
        font-weight: 500;
    }

    .red-underline {
        text-decoration-line: underline;
        text-decoration-color: red;
        text-decoration-thickness: 2px;
        text-underline-offset: 2px;
    }

    body {
        font-family: "KaiTi", "楷体", "STKaiti", "Kaiti SC", "Times New Roman", Georgia, serif;
        font-variant-ligatures: none;
    }

    ul > li {
        list-style-type: disc;
    }

    code {
        color: #24292e;
        background-color: #f6f8fa;
        border: 1px solid #d0d7de;
        border-radius: .375rem;
        padding: .05rem .35rem;
        font-family: "FiraCode Nerd Font", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
        font-size: 0.775rem;
        line-height: 1.1;
    }


    pre {
        margin: 1rem 0;
        padding: .8rem 1rem;
        background-color: #f6f8fa;
        border: 1px solid #d0d7de;
        border-radius: .5rem;
        overflow: auto;
        tab-size: 4;
    }


    pre code {
        display: block;
        padding: 0;
        background: transparent;
        border: 0;
        color: #24292e;
        font-family: "FiraCode Nerd Font", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
        font-size: 0.875rem;
        line-height: 1.5;
        white-space: pre;
    }
</style>
</head>
<!-- * * * * * * * * * * * * * * -->
<body>
<a href="#" class="back-to-top" aria-label="Back to top">
    &#8593;
</a>
<!-- * * * * * * * * * * * * * * -->


<hr/>


<!-- * * * * * * * * * * * * * * -->
<h3 id="security-cors">CORS (Cross-Origin Resource Sharing)</h3>
<ol>

    <li>What Is CORS?</li>
    <br/>
    <ul>
        <li>CORS stands for <b>Cross-Origin Resource Sharing</b>.</li>
        <br/>
        <li>It is a browser security feature that controls whether one website can make requests to another domain.</li>
        <br/>
        <li>CORS is enforced by browsers to prevent malicious JavaScript from accessing protected resources on other origins.</li>
        <br/>
        <li>A “cross-origin” request happens when:
            <ul>
                <li>Protocol is different: <code>http://</code> vs <code>https://</code></li>
                <li>Domain is different: <code>api.example.com</code> vs <code>www.example.com</code></li>
                <li>Port is different: <code>example.com:8000</code> vs <code>example.com:8080</code></li>
            </ul>
        </li>
    </ul>
    <br/><br/>


    <li>Why Is CORS Needed?</li>
    <br/>
    <ul>
        <li>Without CORS, front-end apps would be unable to call external APIs in modern browsers.</li>
        <br/>
        <li>By default, browsers <b>block</b> JavaScript from reading responses from another origin.</li>
        <br/>
        <li>CORS provides a secure way for servers to say:
            <ul>
                <li>“Yes, this other origin is allowed to read my responses.”</li>
                <li>“Here are the methods, headers, and credentials allowed.”</li>
            </ul>
        </li>
    </ul>
    <br/><br/>


    <li>How CORS Works (Simplified)</li>
    <br/>
    <ul>
        <li>When the browser sends a cross-origin request, it adds an <code>Origin</code> header:</li>
<pre><code class="language-http line-numbers">Origin: http://localhost:3000
</code></pre>
        <li>If the server replies with:</li>
<pre><code class="language-http line-numbers">Access-Control-Allow-Origin: http://localhost:3000
</code></pre>
        <li>Then the browser allows the response to be read.</li>
        <br/>
        <li>If not, the browser blocks access and shows a CORS error in the console.</li>
    </ul>
    <br/><br/>


    <li>Preflight Requests</li>
    <br/>
    <ul>
        <li>For “complex” requests (e.g., <code>PUT</code>, <code>DELETE</code>, or custom headers), the browser sends a <b>preflight</b> request first:</li>
<pre><code class="language-http line-numbers">OPTIONS /api/data HTTP/1.1
Origin: http://frontend.com
Access-Control-Request-Method: PUT
Access-Control-Request-Headers: Content-Type
</code></pre>
        <br/>
        <li>The server must respond with:
<pre><code class="language-http line-numbers">Access-Control-Allow-Origin: http://frontend.com
Access-Control-Allow-Methods: GET, POST, PUT
Access-Control-Allow-Headers: Content-Type
</code></pre>
        </li>
        <br/>
        <li>If accepted, the browser continues with the actual request.</li>
    </ul>
    <br/><br/>


    <li>CORS Errors in Practice</li>
    <br/>
    <ul>
        <li>If you see this in the browser:</li>
<pre><code class="language-plaintext line-numbers">Access to fetch at 'https://api.example.com' from origin 'http://localhost:3000'
has been blocked by CORS policy
</code></pre>
        <br/>
        <li>This means the server did not respond with a valid <code>Access-Control-Allow-Origin</code> header.</li>
        <br/>
        <li>This is a browser-side rejection — the request <i>is sent</i>, but the response is inaccessible via JS.</li>
    </ul>
    <br/><br/>


    <li>Enabling CORS in Django</li>
    <br/>
    <ul>
        <li>Django does not support CORS natively — you must use the <b>django-cors-headers</b> package.</li>
        <br/>
        <li>Install it via pip:</li>
<pre><code class="language-bash line-numbers">pip install django-cors-headers</code></pre>
        <br/>
        <li>Add to <code>INSTALLED_APPS</code> and <code>MIDDLEWARE</code>:</li>
<pre><code class="language-python line-numbers">INSTALLED_APPS = [
    ...
    'corsheaders',
    ...
]

MIDDLEWARE = [
    'corsheaders.middleware.CorsMiddleware',
    ...
]
</code></pre>
    </ul>
    <br/><br/>


    <li>Allowing Specific Origins</li>
    <br/>
    <ul>
        <li>To allow a single frontend origin (recommended):</li>
<pre><code class="language-python line-numbers">CORS_ALLOWED_ORIGINS = [
    "http://localhost:3000",
    "https://myfrontend.com",
]
</code></pre>
        <br/>
        <li>To allow all origins (unsafe for production):</li>
<pre><code class="language-python line-numbers">CORS_ALLOW_ALL_ORIGINS = True
</code></pre>
        <br/>
        <li>Other options:
            <ul>
                <li><code>CORS_ALLOW_HEADERS</code> — list of allowed headers</li>
                <li><code>CORS_ALLOW_METHODS</code> — allowed HTTP methods</li>
                <li><code>CORS_ALLOW_CREDENTIALS</code> — allow cookies and Authorization headers</li>
            </ul>
        </li>
    </ul>
    <br/><br/>


    <li>Allowing Cookies (Credentials)</li>
    <br/>
    <ul>
        <li>If your frontend uses <code>withCredentials</code> or sends cookies, set:</li>
<pre><code class="language-python line-numbers">CORS_ALLOW_CREDENTIALS = True
</code></pre>
        <br/>
        <li>And your view must respond with:</li>
<pre><code class="language-http line-numbers">Access-Control-Allow-Credentials: true
</code></pre>
        <br/>
        <li>Note: When credentials are used, <code>*</code> is not allowed in <code>Access-Control-Allow-Origin</code>.</li>
    </ul>
    <br/><br/>


    <li>Tips for Debugging CORS</li>
    <br/>
    <ul>
        <li>Use browser dev tools → Network tab → check the OPTIONS and actual request</li>
        <br/>
        <li>Check if <code>Origin</code> is correctly set</li>
        <br/>
        <li>Inspect response headers — especially:
            <ul>
                <li><code>Access-Control-Allow-Origin</code></li>
                <li><code>Access-Control-Allow-Credentials</code></li>
                <li><code>Access-Control-Allow-Headers</code></li>
            </ul>
        </li>
        <br/>
        <li>Remember: the problem is almost never in the frontend — it’s the <b>server not allowing</b> the origin.</li>
    </ul>
    <br/><br/>


    <li>Security Notes</li>
    <br/>
    <ul>
        <li>Never use <code>CORS_ALLOW_ALL_ORIGINS=True</code> in production unless you are building a public API with no credentials.</li>
        <br/>
        <li>Always validate <code>Origin</code> and return only for trusted domains.</li>
        <br/>
        <li>CORS is not a replacement for authentication — it is simply a browser access policy layer.</li>
    </ul>
    <br/>

</ol>
<!-- * * * * * * * * * * * * * * -->


<hr/>
<!-- * * * * * * * * * * * * * * -->

<footer>
    <p>&copy; 2025 Hwangfucius. All rights reserved.</p>
</footer>
</body>
<!-- * * * * * * * * * * * * * * -->
</html>
<!-- * * * * * * * * * * * * * * -->
